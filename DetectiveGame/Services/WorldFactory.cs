using DetectiveGame.Models;

namespace DetectiveGame.Services
{
    public static class WorldFactory
    {
        public static void InitializeNewGame(GameState gameState)
        {
            // Локации
            var home = new Location("Дом", "Мрачный дом пропавшего. На полу следы грязи, на камине — холодный пепел.");
            home.AddEvidence(new Evidence(
                "Записка",
                "Клочок бумаги с рваным краем.",
                "Буквы выведены нервно, но аккуратно. На полях — едва заметная пометка: \"...Х. знает, где я был ночью\". "
                + "Чернила пахнут аптекой, не канцелярией."
            ));
            home.AddEvidence(new Evidence(
                "Пятно крови",
                "Темное пятно на досках у лестницы.",
                "Кровь старая, но не настолько, чтобы её мог скрыть один лишь туман. Следы будто пытались смыть водой, "
                + "а потом пройтись щеткой. Тот, кто убирал, привык работать чисто."
            ));
            gameState.AddLocation(home);

            var station = new Location("Участок", "Полицейский участок. Здесь шумят, спорят и закрывают дела, чтобы успеть домой к ужину.");
            station.AddEvidence(new Evidence(
                "Объявление о пропаже",
                "Свежий лист с печатью.",
                "Сверху — официальная формулировка, снизу — дописано карандашом: \"проверить доки\". "
                + "Карандашный нажим уверенный, как у человека, привыкшего подписывать рецепты."
            ));
            gameState.AddLocation(station);

            var bar = new Location("Бар", "Бар 'Пьяный лосось'. В воздухе — табак и мокрые пальто, но под ними прячется другой запах.");
            bar.AddEvidence(new Evidence(
                "Бутылка",
                "Пустая бутылка, заткнутая пробкой.",
                "На горлышке — тонкая пленка, пахнет не виски, а чем-то сладко-горьким, аптечным. "
                + "Такое используют, чтобы успокаивать нервы... или чтобы человек не сопротивлялся."
            ));
            bar.AddEvidence(new Evidence(
                "Салфетка с инициалами",
                "Скомканная салфетка с вышивкой.",
                "Вышивка: \"H.H.\" и маленький знак, похожий на кадуцей. Не вяжется с дешевым баром. "
                + "Слишком аккуратно, слишком стерильно — как руки врача."
            ));
            gameState.AddLocation(bar);

            var docks = new Location("Доки", "Переулок у доков. Вода черная, веревки мокрые, а туман делает каждый шаг чужим.");
            docks.AddEvidence(new Evidence(
                "Флакон карболки",
                "Разбитый стеклянный флакон.",
                "Карболка. Её запах не спутать ни с чем. Врачи любят говорить, что это запах спасения, "
                + "но ночью он пахнет иначе — как попытка стереть следы."
            ));
            docks.AddEvidence(new Evidence(
                "Серебряная пуговица",
                "Тяжелая пуговица с гравировкой.",
                "Гравировка мелкая: медицинский символ и инициалы владельца. "
                + "Пуговица дорогая, не рабочая. Кто-то был здесь в хорошем пальто — и явно не ради прогулки."
            ));
            gameState.AddLocation(docks);

            var pawnshop = new Location("Ломбард", "Ломбард Грима. Тут меряют человеческую совесть весами и ценником.");
            pawnshop.AddEvidence(new Evidence(
                "Квитанция ломбарда",
                "Квитанция, выписанная на имя Блэквуда.",
                "Внизу подпись ростовщика и отметка: \"выкуплено сегодня ночью\". Подпись получателя — аккуратная, врачебная. "
                + "Если это не он, то кто так пишет?"
            ));
            gameState.AddLocation(pawnshop);

            var clinic = new Location("Кабинет доктора", "Кабинет доктора Харроу. Чистота здесь не уют, а угроза: слишком уж всё стерильно.");
            clinic.AddEvidence(new Evidence(
                "Журнал пациентов",
                "Толстая тетрадь с именами и датами.",
                "Между страниц — закладка на ночном визите: \"B. — поздно, без свидетелей\". "
                + "Рядом — пометка: \"оплата не деньгами\". Пахнет шантажом."
            ));
            clinic.AddEvidence(new Evidence(
                "Рецепт с инициалами",
                "Бланк с подписью врача.",
                "Рецепт выписан на снотворное. На краю — след от мокрой перчатки и микроскопическая капля крови. "
                + "Подпись совпадает с каракулями на других бумагах — рука одна и та же."
            ));
            gameState.AddLocation(clinic);

            var mansion = new Location("Особняк", "Особняк Роуэн. Здесь даже тишина имеет цену, а слуги не задают вопросов.");
            mansion.AddEvidence(new Evidence(
                "Письмо с печатью",
                "Запечатанный конверт, вскрытый ножом.",
                "В письме — угроза: \"Если заговоришь — лекарства станут твоим приговором\". "
                + "Внизу — едва заметные инициалы: \"H\". Чернила те же, что и на записке из дома."
            ));
            gameState.AddLocation(mansion);

            // Персонажи
            gameState.AddCharacter(new Character("Сержант", "Полицейский", "Участок", isSuspect: true));
            gameState.AddCharacter(new Character("Бармен", "Свидетель", "Бар", isSuspect: true));
            gameState.AddCharacter(new Character("Леди Эвелин", "Родственница", "Особняк", isSuspect: true));
            gameState.AddCharacter(new Character("Ростовщик Грим", "Ростовщик", "Ломбард", isSuspect: true));
            gameState.AddCharacter(new Character("Доктор Харроу", "Врач", "Кабинет доктора", isSuspect: true));
            gameState.AddCharacter(new Character("Газетчик", "Сплетник", "Доки", isSuspect: false));

            gameState.CurrentLocationName = "Дом";
        }
    }
}
